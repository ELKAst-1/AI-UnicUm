import os
import subprocess
import sys
import shutil


def install_requirements():
    """Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ñ‹Ñ… Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐº"""
    requirements = [
        'customtkinter==5.2.2', 'pandas>=2.0.0', 'openpyxl==3.0.10',
        'qrcode[pil]==7.3.1', 'Pillow==9.4.0', 'numpy<2.0.0'
    ]

    print("Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ñ‹Ñ… Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐº...")
    for package in requirements:
        try:
            subprocess.check_call(
                [sys.executable, "-m", "pip", "install", package])
            print(f"âœ“ Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¾: {package}")
        except subprocess.CalledProcessError:
            print(f"âœ— ÐžÑˆÐ¸Ð±ÐºÐ° ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸: {package}")


def create_config_files():
    """Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ñ… Ñ„Ð°Ð¹Ð»Ð¾Ð²"""
    config_files = {
        'config/receipt_config.txt':
        """[Ð§ÐµÐº]
ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ_ÐºÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ð¸=Pizza Maker
Ð˜ÐÐ=1234567890
ÐÐ´Ñ€ÐµÑ=Ð³. ÐœÐ¾ÑÐºÐ²Ð°, ÑƒÐ». ÐŸÑƒÑˆÐºÐ¸Ð½Ð°, Ð´. 1
Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½=+7 (495) 123-45-67
Ð¡Ð°Ð¹Ñ‚=https://pizza-maker.ru
ÐÐ”Ð¡=20%%

[QR]
Ð¡ÑÑ‹Ð»ÐºÐ°=https://genius-school.kuzstu.ru/pizza-maker
""",
        'config/menu_adult.txt':
        """[ÐŸÐ¸Ñ†Ñ†Ñ‹]
ÐœÐ°Ñ€Ð³Ð°Ñ€Ð¸Ñ‚Ð°=450|Ð‘Ð¾Ð»ÑŒÑˆÐ°Ñ|ÑÑ‹Ñ€, Ñ‚Ð¾Ð¼Ð°Ñ‚Ñ‹, ÑÐ¾ÑƒÑ
ÐŸÐµÐ¿Ð¿ÐµÑ€Ð¾Ð½Ð¸=550|Ð‘Ð¾Ð»ÑŒÑˆÐ°Ñ|Ð¿ÐµÐ¿Ð¿ÐµÑ€Ð¾Ð½Ð¸, ÑÑ‹Ñ€, ÑÐ¾ÑƒÑ
Ð“Ð°Ð²Ð°Ð¹ÑÐºÐ°Ñ=500|Ð‘Ð¾Ð»ÑŒÑˆÐ°Ñ|Ð²ÐµÑ‚Ñ‡Ð¸Ð½Ð°, Ð°Ð½Ð°Ð½Ð°ÑÑ‹, ÑÑ‹Ñ€
Ð§ÐµÑ‚Ñ‹Ñ€Ðµ_ÑÑ‹Ñ€Ð°=600|Ð‘Ð¾Ð»ÑŒÑˆÐ°Ñ|4 Ð²Ð¸Ð´Ð° ÑÑ‹Ñ€Ð°
ÐšÐ°ÑÑ‚Ð¾Ð¼Ð½Ð°Ñ=400|Ð‘Ð¾Ð»ÑŒÑˆÐ°Ñ|Ð½Ð° Ð²Ð°Ñˆ Ð²Ñ‹Ð±Ð¾Ñ€

[ÐÐ°Ð¿Ð¸Ñ‚ÐºÐ¸]
ÐšÐ¾Ð»Ð°=150|1Ð»
Ð¤Ð°Ð½Ñ‚Ð°=150|1Ð»
Ð¡Ð¿Ñ€Ð°Ð¹Ñ‚=150|1Ð»
Ð’Ð¾Ð´Ð°=100|1Ð»
Ð¡Ð¾Ðº=200|1Ð»
""",
        'config/menu_minor.txt':
        """[ÐŸÐ¸Ñ†Ñ†Ñ‹]
ÐœÐ°Ñ€Ð³Ð°Ñ€Ð¸Ñ‚Ð°=350|Ð¡Ñ€ÐµÐ´Ð½ÑÑ|ÑÑ‹Ñ€, Ñ‚Ð¾Ð¼Ð°Ñ‚Ñ‹, ÑÐ¾ÑƒÑ
ÐŸÐµÐ¿Ð¿ÐµÑ€Ð¾Ð½Ð¸=450|Ð¡Ñ€ÐµÐ´Ð½ÑÑ|Ð¿ÐµÐ¿Ð¿ÐµÑ€Ð¾Ð½Ð¸, ÑÑ‹Ñ€, ÑÐ¾ÑƒÑ
Ð“Ð°Ð²Ð°Ð¹ÑÐºÐ°Ñ=400|Ð¡Ñ€ÐµÐ´Ð½ÑÑ|Ð²ÐµÑ‚Ñ‡Ð¸Ð½Ð°, Ð°Ð½Ð°Ð½Ð°ÑÑ‹, ÑÑ‹Ñ€
Ð§ÐµÑ‚Ñ‹Ñ€Ðµ_ÑÑ‹Ñ€Ð°=500|Ð¡Ñ€ÐµÐ´Ð½ÑÑ|4 Ð²Ð¸Ð´Ð° ÑÑ‹Ñ€Ð°
ÐšÐ°ÑÑ‚Ð¾Ð¼Ð½Ð°Ñ=300|Ð¡Ñ€ÐµÐ´Ð½ÑÑ|Ð½Ð° Ð²Ð°Ñˆ Ð²Ñ‹Ð±Ð¾Ñ€

[ÐÐ°Ð¿Ð¸Ñ‚ÐºÐ¸]
ÐšÐ¾Ð»Ð°=100|0.5Ð»
Ð¤Ð°Ð½Ñ‚Ð°=100|0.5Ð»
Ð¡Ð¿Ñ€Ð°Ð¹Ñ‚=100|0.5Ð»
Ð’Ð¾Ð´Ð°=80|0.5Ð»
Ð¡Ð¾Ðº=150|0.5Ð»
""",
        'config/toppings.txt':
        """Ð¡Ñ‹Ñ€=50
ÐŸÐµÐ¿Ð¿ÐµÑ€Ð¾Ð½Ð¸=70
Ð’ÐµÑ‚Ñ‡Ð¸Ð½Ð°=60
Ð“Ñ€Ð¸Ð±Ñ‹=40
ÐÐ½Ð°Ð½Ð°ÑÑ‹=45
ÐžÐ»Ð¸Ð²ÐºÐ¸=35
Ð¢Ð¾Ð¼Ð°Ñ‚Ñ‹=30
Ð›ÑƒÐº=25
ÐŸÐµÑ€ÐµÑ†=35
"""
    }

    print("Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ñ… Ñ„Ð°Ð¹Ð»Ð¾Ð²...")
    if not os.path.exists('config'):
        os.makedirs('config')

    for file_path, content in config_files.items():
        with open(file_path, 'w', encoding='utf-8') as f:
            f.write(content)
        print(f"âœ“ Ð¡Ð¾Ð·Ð´Ð°Ð½: {file_path}")


def create_data_files():
    """Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ñ„Ð°Ð¹Ð»Ð¾Ð² Ð´Ð°Ð½Ð½Ñ‹Ñ…"""
    import pandas as pd

    print("Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ñ„Ð°Ð¹Ð»Ð¾Ð² Ð´Ð°Ð½Ð½Ñ‹Ñ…...")

    # Ð¤Ð°Ð¹Ð» Ð·Ð°ÐºÐ°Ð·Ð¾Ð²
    orders_data = pd.DataFrame(columns=[
        "ID", "Ð”Ð°Ñ‚Ð°", "Ð¤Ð˜Ðž", "Ð’Ð¾Ð·Ñ€Ð°ÑÑ‚", "Ð—Ð°ÐºÐ°Ð·", "Ð¡ÑƒÐ¼Ð¼Ð°", "ÐžÐ¿Ð»Ð°Ñ‚Ð°", "Ð¡Ð´Ð°Ñ‡Ð°"
    ])
    orders_data.to_excel('orders.xlsx', index=False)
    print("âœ“ Ð¡Ð¾Ð·Ð´Ð°Ð½: orders.xlsx")

    # Ð¤Ð°Ð¹Ð» Ð¾ÑÑ‚Ð°Ñ‚ÐºÐ¾Ð²
    inventory_data = {
        "ÐŸÑ€Ð¾Ð´ÑƒÐºÑ‚": [
            "Ð¢ÐµÑÑ‚Ð¾", "Ð¡Ñ‹Ñ€", "ÐŸÐµÐ¿Ð¿ÐµÑ€Ð¾Ð½Ð¸", "Ð’ÐµÑ‚Ñ‡Ð¸Ð½Ð°", "Ð“Ñ€Ð¸Ð±Ñ‹", "ÐÐ½Ð°Ð½Ð°ÑÑ‹",
            "ÐžÐ»Ð¸Ð²ÐºÐ¸", "Ð¢Ð¾Ð¼Ð°Ñ‚Ñ‹", "Ð›ÑƒÐº", "ÐŸÐµÑ€ÐµÑ†", "ÐšÐ¾Ð»Ð°", "Ð¤Ð°Ð½Ñ‚Ð°", "Ð¡Ð¿Ñ€Ð°Ð¹Ñ‚",
            "Ð’Ð¾Ð´Ð°", "Ð¡Ð¾Ðº"
        ],
        "ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾":
        [100, 100, 50, 40, 30, 25, 20, 35, 25, 30, 50, 50, 50, 50, 40],
        "Ð•Ð´Ð¸Ð½Ð¸Ñ†Ð°": [
            "ÑˆÑ‚", "ÐºÐ³", "ÐºÐ³", "ÐºÐ³", "ÐºÐ³", "ÐºÐ³", "ÐºÐ³", "ÐºÐ³", "ÐºÐ³", "ÐºÐ³", "Ð»",
            "Ð»", "Ð»", "Ð»", "Ð»"
        ]
    }
    inventory_df = pd.DataFrame(inventory_data)
    inventory_df.to_excel('inventory.xlsx', index=False)
    print("âœ“ Ð¡Ð¾Ð·Ð´Ð°Ð½: inventory.xlsx")


def main():
    print("=" * 50)
    print("       Ð£Ð¡Ð¢ÐÐÐžÐ’Ð©Ð˜Ðš PIZZA MAKER")
    print("=" * 50)

    try:
        install_requirements()
        create_config_files()
        create_data_files()

        print("\n" + "=" * 50)
        print("Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð° ÑƒÑÐ¿ÐµÑˆÐ½Ð¾! ðŸŽ‰")
        print("Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚Ðµ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ: python pizza_maker_app.py")
        print("=" * 50)

    except Exception as e:
        print(f"\nÐžÑˆÐ¸Ð±ÐºÐ° ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸: {e}")
        input("ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ Enter Ð´Ð»Ñ Ð²Ñ‹Ñ…Ð¾Ð´Ð°...")


if __name__ == "__main__":
    main()
